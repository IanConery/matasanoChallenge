var hexHash = {
  '0' : '0000',
  '1' : '0001',
  '2' : '0010',
  '3' : '0011',
  '4' : '0100',
  '5' : '0101',
  '6' : '0110',
  '7' : '0111',
  '8' : '1000',
  '9' : '1001',
  'a' : '1010',
  'b' : '1011',
  'c' : '1100',
  'd' : '1101',
  'e' : '1110',
  'f' : '1111'
};

var XORHash = {
  '00' : '0',
  '10' : '1',
  '01' : '1',
  '11' : '0'
};

var byteValues = [128,64,32,16,8,4,2,1];

var alphabet = {a:0,b:0,c:0,d:0,e:0,f:0,g:0,h:0,i:0,j:0,k:0,l:0,m:0,n:0,o:0,p:0,q:0,r:0,s:0,t:0,u:0,v:0,w:0,x:0,y:0,z:0};

var topOne = function(array){
  var mostCommon = [0, -1, 0];
  array.forEach(function(subArray, index){
    var string = subArray[0];
    var key = subArray[1];
    var temp = 0;
    for(var i = 0; i < string.length; i++){
      if(alphabet[string[i]] !== undefined){
        temp ++;
      }
    }
    if(temp > mostCommon[0]){
      mostCommon[0] = temp;
      mostCommon[1] = index; 
      mostCommon[2] = key
    }
  });
  return array[mostCommon[1]];
}

var hexToBinary = function(string){
  var result = '';
  for(var i = 0; i < string.length; i++){
    result += hexHash[string[i]];
  }
  return result;
}

var binToASCIICode = function(string){
  string = string.split('');
  var ASCIIValues = [];
  while(string.length >= 8){
    var temp = string.splice(0,8).join('');
    ASCIIValues.push(parseInt(temp, 2));
  }
  return ASCIIValues;
}

var ASCIIToChar = function(array){
  var result = '';
  array.forEach(function(code){
    result += String.fromCharCode(code);
  });
  return result;
}

var reverseXOR = function(encryptedByte, possKeyByte){
  var possOriginalByte = '';
  for(var i = 0; i < 8; i++){
    var tempBit = encryptedByte[i] + possKeyByte[i];
    possOriginalByte += XORHash[tempBit];
  }
  return possOriginalByte;
};


var decToBinary = function(base10){
  var binaryStr = '';
  for(var i = 0; i < byteValues.length; i++){
    if(base10 >= byteValues[i]){
      base10 = base10 - byteValues[i];
      binaryStr += '1';
    }else{
      binaryStr += '0';
    }
  }
  return binaryStr;
};


var charToHex = function(char){
  var bin = decToBinary(char.charCodeAt(0)).split('');
  var result = '';
  while(bin.length >= 4){
    var temp = bin.splice(0,4).join('');
    for(var key in hexHash){
      if(hexHash[key] === temp){
        result += key;
      }
    }
  }
  return result;
};


var singleByteCipher = function(string){
  // string = hexToBinary(string).split('');
  var resultsArray = [];

  for(var i = 0; i < 128; i++){
    var test = decToBinary(i);
    var tempString = string.slice(0);
    var tempArray = [];

    while(tempString.length >= 8){
      var binChar = reverseXOR(tempString.splice(0,8).join('').toString(), test);
      binChar = binToASCIICode(binChar);
      tempArray.push(ASCIIToChar(binChar));
    }
    resultsArray.push([tempArray.join(''), String.fromCharCode(parseInt(test, 2))]);
  }
  return topOne(resultsArray);
  // return resultsArray;
};

var stringToHex = function(string){
  var hexString = '';
  for(var i = 0; i < string.length; i++){
    hexString += charToHex(string[i]);
  }
  return hexString;
}

// console.log(singleByteCipher('1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736'));
//Cooking MC's like a pound of bacon  || challenge 3
//Now that the party is jumping     || challenge 4

var possibleAnswer = [ [ '00011101',
    '00011111',
    '00001011',
    '00000010',
    '01001111',
    '01001110',
    '00011010',
    '01100101',
    '01001001',
    '00001110',
    '00010011',
    '00001011',
    '01001110',
    '00000001',
    '01000101',
    '00000000',
    '00000001',
    '01100100',
    '01010100',
    '00011101',
    '00110011',
    '01001110',
    '01010010',
    '00000000',
    '01010100',
    '00001101',
    '01001101',
    '00000100',
    '01010011',
    '00111100',
    '00011110',
    '01001001',
    '00001001',
    '01001111',
    '01001100',
    '00011010',
    '00101011',
    '00000101',
    '01000111',
    '00010001',
    '00001001',
    '01100100',
    '00000111',
    '00000000',
    '00010110',
    '00001100',
    '00010111',
    '00011101',
    '01010010',
    '00110000',
    '00000000',
    '00010011',
    '00000101',
    '01001111',
    '01001000',
    '01000101',
    '01100101',
    '00010110',
    '00111000',
    '00000110',
    '00001000',
    '01000110',
    '01001111',
    '01011001',
    '01111110',
    '01100010',
    '00001100',
    '00001111',
    '00001101',
    '00000110',
    '00011010',
    '00000000',
    '01000010',
    '00000100',
    '00000001',
    '00011010',
    '00010001',
    '01010010',
    '01111111',
    '00000000',
    '00111010',
    '00011010',
    '01001001',
    '01001111',
    '01001000',
    '00011101',
    '01010011',
    '00111010',
    '01010010',
    '00000001',
    '01000001',
    '00000110',
    '01001100',
    '01011111',
    '01100010',
    '00000110',
    '00001001',
    '01010100',
    '00010111',
    '00010100',
    '01001001',
    '00110011',
    '00001011',
    '00000001',
    '00001111',
    '00000111',
    '00011101',
    '01111000',
    '01001000',
    '01010010',
    '00000111',
    '01000101',
    '01001000',
    '01000001',
    '01001111',
    '01010100',
    '01110100',
    '00011101',
    '01001001',
    '00000000',
    '00010110',
    '00000000',
    '00110000',
    '01100101',
    '01001001',
    '00000010',
    '00000000',
    '00001011',
    '01001110',
    '00010000',
    '00000001',
    '00010000',
    '01001101',
    '00000111',
    '00011111',
    '00011011',
    '01111000',
    '01101001',
    '01010010',
    '00000001',
    '01010100',
    '00000111',
    '01010011',
    '00000010',
    '01010011',
    '00111011',
    '00000110',
    '01001001',
    '00001111',
    '01001111',
    '00000000',
    '01011111',
    '00101011',
    '01001001',
    '00110011',
    '01010100',
    '00010000',
    '00011010',
    '00000101',
    '00010001',
    '00001100',
    '01001101',
    '00000010',
    '00000011',
    '01010010',
    '00111101',
    '00000000',
    '00001011',
    '00001101',
    '01001110',
    '00001101',
    '01010100',
    '01001111',
    '00011100',
    '01011110',
    '00001011',
    '00011001',
    '00010010',
    '00001010',
    '01010011',
    '01001110',
    '01100010',
    '00000001',
    '01000111',
    '00011101',
    '00000000',
    '00010111',
    '00000101',
    '00001100',
    '01000010',
    '01001101',
    '00000001',
    '00100010',
    '00011100',
    '00110100',
    '01000001',
    '00110101',
    '01001111',
    '00101010',
    '00111011',
    '01001111',
    '00011011',
    '01010011',
    '00110111',
    '00000111',
    '00001100',
    '00010101',
    '00001110',
    '00000111',
    '00011010',
    '00101010',
    '01001001',
    '00000110',
    '01010100',
    '01000101',
    '00000111',
    '00000101',
    '00000111',
    '01000101',
    '00101100',
    '00001010',
    '00011101',
    '01010010',
    '00110111',
    '00000000',
    '00011101',
    '01001001',
    '00000000',
    '00000001',
    '01000101',
    '00001110',
    '00010111',
    '00111001',
    '01011110',
    '00011101',
    '00000100',
    '01001111',
    '01110111',
    '01000011',
    '00111011',
    '00011100',
    '00010100',
    '00010101' ],
  [ '01000010',
    '01001101',
    '00001111',
    '00011111',
    '00010011',
    '00111100',
    '01101001',
    '00011111',
    '00011100',
    '01001110',
    '00000001',
    '00000111',
    '00011011',
    '00010110',
    '00110110',
    '00011110',
    '01001001',
    '00100000',
    '00011101',
    '01000011',
    '01010011',
    '01100101',
    '00000110',
    '01000111',
    '00011100',
    '01000101',
    '00000111',
    '00001100',
    '00010010',
    '00001100',
    '00001000',
    '00011010',
    '00010001',
    '00010100',
    '00100001',
    '01000111',
    '00000000',
    '00011101',
    '01011001',
    '00000100',
    '00000000',
    '00100110',
    '01010011',
    '00110111',
    '00000110',
    '00011010',
    '01000001',
    '00000001',
    '01010100',
    '01011111',
    '00100000',
    '00001010',
    '01000111',
    '00010010',
    '00001000',
    '01001110',
    '00111110',
    '00001001',
    '01000101',
    '00000101',
    '00011010',
    '00000111',
    '00011111',
    '01111000',
    '01101010',
    '00110110',
    '00011101',
    '01000001',
    '01001000',
    '01010101',
    '00011011',
    '00011101',
    '01110100',
    '00011110',
    '01001001',
    '00001001',
    '00000010',
    '01111010',
    '01001001',
    '01001000',
    '00000000',
    '00010011',
    '00011010',
    '01000101',
    '00001111',
    '00001101',
    '00000100',
    '00000001',
    '00011001',
    '00001011',
    '00010011',
    '00000000',
    '00110001',
    '01010011',
    '00010101',
    '00000111',
    '00000111',
    '00001011',
    '01000001',
    '00010110',
    '01111001',
    '00110101',
    '00011011',
    '00000101',
    '01000110',
    '01001111',
    '01001110',
    '01001110',
    '00100111',
    '00000100',
    '00001100',
    '01011000',
    '00001000',
    '00000000',
    '00100000',
    '00001000',
    '00001011',
    '00011001',
    '00000010',
    '00001110',
    '01011100',
    '01010010',
    '01101001',
    '00011111',
    '00000010',
    '01010100',
    '00000001',
    '00000111',
    '00000010',
    '01010011',
    '00100110',
    '00010101',
    '00000010',
    '00000010',
    '01001111',
    '01001110',
    '00110000',
    '00110110',
    '00001010',
    '00001001',
    '00000110',
    '00001001',
    '01001110',
    '00010000',
    '00001000',
    '00010000',
    '00000101',
    '00001111',
    '00010000',
    '00111011',
    '00111010',
    '01000111',
    '00011100',
    '01100100',
    '01001111',
    '00000010',
    '01010011',
    '01001111',
    '00010110',
    '01110100',
    '00000110',
    '00001111',
    '00001110',
    '01000011',
    '01001100',
    '01001110',
    '00101111',
    '01001001',
    '00001000',
    '00010111',
    '00010101',
    '00011101',
    '00001110',
    '01000101',
    '00101000',
    '01001101',
    '00000001',
    '00000111',
    '01010101',
    '01111000',
    '01001111',
    '00000110',
    '00001011',
    '01010011',
    '00001100',
    '00000000',
    '00001010',
    '00011111',
    '00111010',
    '01011110',
    '00101110',
    '01000001',
    '00001110',
    '01001001',
    '01010110',
    '01100010',
    '00000110',
    '01000111',
    '01111110',
    '00001000',
    '00000001',
    '00000001',
    '01000010',
    '00000100',
    '00011110',
    '01001110',
    '00011100',
    '00000110',
    '00101011',
    '01010100',
    '00010111',
    '00011001',
    '01011001',
    '00100001',
    '01010111',
    '00000011',
    '01010011',
    '00110001',
    '01111000',
    '00000111',
    '01000001',
    '00001001',
    '01011001',
    '01001111',
    '00100110',
    '00000111',
    '00010011',
    '00010011',
    '00010011',
    '01001110',
    '01001001',
    '00000100',
    '00001011',
    '01001101',
    '00000110',
    '00011010',
    '01111000',
    '00110000',
    '00000000',
    '00011101',
    '01001110',
    '01010100',
    '00011010' ] ];
possibleAnswer.forEach(function(sub){
  console.log(singleByteCipher(sub.join('').split('')));  
});
// console.log(singleByteCipher(possibleAnswer[1].join('').split('')));